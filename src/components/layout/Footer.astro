---
import LanguagePicker from "../LanguagePicker.astro";
import {
  getLangFromUrl,
  getRouteKeyFromPath,
  useTranslatedPath,
  useTranslations,
} from "@/i18n/utils";
import { defaultLang, ui } from "@/i18n/ui";
import { menuLinks } from "@/site.config";

const year = new Date().getFullYear();
const currentLang = getLangFromUrl(Astro.url);
const translateForLang = useTranslatedPath(currentLang);
const t = useTranslations(currentLang);
type TranslationKey = keyof (typeof ui)[typeof defaultLang];

const navItems = menuLinks.map((link) => {
  const routeKey = getRouteKeyFromPath(link.path) ?? "home";
  const translationKey = `nav.${routeKey}` as TranslationKey;

  return {
    href: translateForLang(link.path),
    label: t(translationKey),
  };
});
---

<footer
  class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pt-20 pb-4 text-center align-top font-semibold text-gray-600 sm:flex-row sm:justify-between sm:text-xs dark:text-gray-400"
>
  <div class="me-0 sm:me-4">
    &copy; {year}.<span class="inline-block"
      >&nbsp;ðŸš€&nbsp;Built with Astro</span
    >
  </div>
  <nav
    aria-labelledby="footer_links"
    class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500"
  >
    <p id="footer_links" class="sr-only">More on this site</p>
    {
      navItems.map((item) => (
        <a
          class="hover:text-global-text px-4 py-2 hover:underline sm:py-0"
          href={item.href}
        >
          {item.label}
        </a>
      ))
    }
  </nav>
  <LanguagePicker />
</footer>
